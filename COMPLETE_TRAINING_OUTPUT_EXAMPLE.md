# 完整训练输出示例

## 📋 概述

现在每轮训练后都会打印训练集、验证集和测试集的完整结果，包含所有F1分数。

## 🎯 新功能特点

✅ **三数据集评估**: 每轮训练后评估训练集、验证集、测试集  
✅ **完整F1分数**: 包含所有F1相关指标  
✅ **彩色区分**: 🔵训练集 🟡验证集 🔴测试集  
✅ **最佳模型追踪**: 基于验证集损失保存最佳模型  

## 📊 输出格式示例

### MOSI 数据集输出
```
📊 Epoch 1/25 完整评估结果:
================================================================================
🔵 训练集结果:
   Loss: 0.823456
   MAE: 0.654321
   Corr: 0.567890
   Has0_acc_2: 0.789012
   Has0_F1_score: 0.756789
   Non0_acc_2: 0.678901
   Non0_F1_score: 0.645678
   Mult_acc_5: 0.567890
   Mult_acc_7: 0.456789
🟡 验证集结果:
   Loss: 0.856789
   MAE: 0.687654
   Corr: 0.534567
   Has0_acc_2: 0.756789
   Has0_F1_score: 0.723456
   Non0_acc_2: 0.645678
   Non0_F1_score: 0.612345
   Mult_acc_5: 0.534567
   Mult_acc_7: 0.423456
🔴 测试集结果:
   Loss: 0.867890
   MAE: 0.698765
   Corr: 0.523456
   Has0_acc_2: 0.745678
   Has0_F1_score: 0.712345
   Non0_acc_2: 0.634567
   Non0_F1_score: 0.601234
   Mult_acc_5: 0.523456
   Mult_acc_7: 0.412345

🎉 新的最佳模型已保存! (验证集 Best Loss: 0.856789)
================================================================================
```

### MOSEI 数据集输出
```
📊 Epoch 1/25 完整评估结果:
================================================================================
🔵 训练集结果:
   Loss: 1.234567
   MAE: 0.876543
   Corr: 0.456789
   Has0_acc_2: 0.723456
   Has0_F1_score: 0.698765
   Non0_acc_2: 0.634567
   Non0_F1_score: 0.612345
   Mult_acc_5: 0.545678
   Mult_acc_7: 0.434567
🟡 验证集结果:
   Loss: 1.267890
   MAE: 0.898765
   Corr: 0.423456
   Has0_acc_2: 0.698765
   Has0_F1_score: 0.667890
   Non0_acc_2: 0.612345
   Non0_F1_score: 0.589012
   Mult_acc_5: 0.523456
   Mult_acc_7: 0.412345
🔴 测试集结果:
   Loss: 1.278901
   MAE: 0.909876
   Corr: 0.412345
   Has0_acc_2: 0.687654
   Has0_F1_score: 0.656789
   Non0_acc_2: 0.601234
   Non0_F1_score: 0.578901
   Mult_acc_5: 0.512345
   Mult_acc_7: 0.401234

🎉 新的最佳模型已保存! (验证集 Best Loss: 1.267890)
================================================================================
```

### SIMS 数据集输出
```
📊 Epoch 1/25 完整评估结果:
================================================================================
🔵 训练集结果:
   Loss: 0.987654
   MAE: 0.743210
   Corr: 0.512345
   Mult_acc_2: 0.678901
   Mult_acc_3: 0.567890
   Mult_acc_5: 0.456789
   F1_score: 0.654321
🟡 验证集结果:
   Loss: 1.012345
   MAE: 0.765432
   Corr: 0.489012
   Mult_acc_2: 0.656789
   Mult_acc_3: 0.545678
   Mult_acc_5: 0.434567
   F1_score: 0.632109
🔴 测试集结果:
   Loss: 1.023456
   MAE: 0.776543
   Corr: 0.478901
   Mult_acc_2: 0.645678
   Mult_acc_3: 0.534567
   Mult_acc_5: 0.423456
   F1_score: 0.620987

🎉 新的最佳模型已保存! (验证集 Best Loss: 1.012345)
================================================================================
```

## 🔍 指标说明

### MOSI/MOSEI 指标
- **Has0_F1_score**: 包含中性样本的F1分数
- **Non0_F1_score**: 排除中性样本的F1分数
- **Has0_acc_2**: 包含中性样本的二分类准确率
- **Non0_acc_2**: 排除中性样本的二分类准确率
- **Mult_acc_5/7**: 5分类/7分类准确率

### SIMS 指标
- **F1_score**: 加权F1分数
- **Mult_acc_2/3/5**: 2分类/3分类/5分类准确率

## 💡 使用建议

### 1. 性能监控
- **训练集**: 观察模型是否正常学习
- **验证集**: 用于模型选择和早停
- **测试集**: 真实性能评估

### 2. 过拟合检测
- 训练集性能持续提升，验证集/测试集性能下降 → 过拟合
- 三个数据集性能趋势一致 → 训练正常

### 3. 实验分析
- F1分数比准确率更能反映不平衡数据的性能
- 关注验证集和测试集的F1分数差异
- 如果测试集性能明显低于验证集，可能存在数据分布差异

## ⚠️ 注意事项

### 计算开销
- 每轮评估三个数据集会增加训练时间
- 训练集通常最大，评估时间最长
- 建议在GPU上运行以加速评估

### 最佳实践
- 最佳模型基于验证集损失保存
- 测试集结果仅供参考，避免基于测试集调参
- 可以通过验证集和测试集的一致性判断模型泛化能力

## 🚀 运行方法

现在直接运行主函数即可：

```bash
# MOSI数据集
cd MOSI
python main.py

# MOSEI数据集
cd MOSEI
python main.py

# SIMS数据集
cd SIMS
python main.py
```

每轮训练后都会自动显示完整的三数据集评估结果！
